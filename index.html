<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIN ME UP! - Sklep Studencki</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #4834d4; /* Gbszy, nowoczesny fiolet */
            --primary-dark: #301b9e;
            --salmon: #ff7979;  /* 呕ywszy koral */
            --salmon-light: #ffcccc;
            --accent: #f9ca24;  /* Zoto */
            --bg-color: #f7f1ff;
            --text-main: #2d3436;
            --glass: rgba(255, 255, 255, 0.9);
            --shadow: 0 10px 40px -10px rgba(72, 52, 212, 0.15);
            --radius: 16px;
        }

        body { 
            font-family: 'Montserrat', sans-serif; 
            background-color: var(--bg-color); 
            background-image: radial-gradient(#e0d4fc 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--text-main); 
            margin: 0; 
            padding-top: 140px; /* Miejsce na Header + Banner */
        }

        /* --- EVENT BANNER --- */
        .event-banner {
            background: linear-gradient(45deg, #ff0055, #ff7979, #f9ca24);
            background-size: 200% 200%;
            color: white;
            text-align: center;
            padding: 12px 10px;
            font-size: 0.9rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 1002;
            animation: gradientMove 5s ease infinite;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .event-highlight {
            background: rgba(0,0,0,0.2);
            padding: 2px 8px;
            border-radius: 4px;
            margin: 0 3px;
            display: inline-block;
        }

        /* --- HEADER --- */
        header { 
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 10px 0; 
            position: fixed; 
            top: 0; 
            width: 100%; 
            z-index: 1000; 
            border-bottom: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 4px 30px rgba(0,0,0,0.05);
        }
        
        .header-container {
            /* Kontener trzymajcy banner i nav w jednym fixed bloku */
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .nav-inner { 
            max-width: 1200px; 
            margin: 0 auto; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 10px 20px; 
        }

        .logo { 
            font-weight: 900; 
            font-size: 1.6rem; 
            color: var(--primary); 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            cursor: pointer; 
            text-shadow: 2px 2px 0px rgba(0,0,0,0.05);
        }
        .logo img { 
            height: 50px; 
            border-radius: 50%; 
            border: 3px solid var(--primary); 
            transition: transform 0.3s;
        }
        .logo:hover img { transform: rotate(10deg); }

        .cart-btn { 
            background: var(--primary); 
            color: white; 
            padding: 12px 25px; 
            border-radius: 50px; 
            font-weight: 700; 
            text-decoration: none; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            transition: 0.3s; 
            box-shadow: 0 4px 15px rgba(72, 52, 212, 0.4);
        }
        .cart-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(72, 52, 212, 0.6); 
            background: var(--primary-dark);
        }

        /* --- LAYOUT --- */
        .main-wrapper { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 20px; 
            display: grid; 
            grid-template-columns: 2fr 1.1fr; 
            gap: 40px; 
            align-items: start; 
        }
        @media (max-width: 900px) { .main-wrapper { grid-template-columns: 1fr; } }

        /* --- AKORDEONY & SEKCJE --- */
        .accordion-item { 
            background: var(--glass); 
            border-radius: var(--radius); 
            margin-bottom: 25px; 
            overflow: hidden; 
            box-shadow: var(--shadow); 
            border: 1px solid white;
            transition: 0.3s;
        }
        .accordion-item:hover { transform: translateY(-3px); }

        .accordion-header { 
            padding: 25px; 
            cursor: pointer; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            font-weight: 800; 
            font-size: 1.1rem;
            color: var(--primary); 
            background: white; 
            transition: 0.3s; 
        }
        .accordion-header:hover { background: #fdfdfd; color: var(--salmon); }
        .accordion-header i { transition: 0.3s; }
        .accordion-item.active .accordion-header { border-bottom: 1px solid #f0f0f0; }
        .accordion-item.active .accordion-header i { transform: rotate(180deg); }
        
        .accordion-content { display: none; padding: 25px; animation: fadeIn 0.4s; }
        .accordion-item.active .accordion-content { display: block; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- KARTY PRODUKTW --- */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 20px; }
        
        .card { 
            border: 1px solid #f0f0f0; 
            border-radius: 15px; 
            padding: 20px 15px; 
            text-align: center; 
            background: white; 
            transition: 0.3s; 
            position: relative;
        }
        .card:hover { 
            transform: translateY(-8px); 
            border-color: var(--salmon); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
        }
        .card img { 
            width: 110px; height: 110px; 
            border-radius: 50%; 
            object-fit: cover; 
            margin-bottom: 15px; 
            border: 4px solid var(--bg-color); 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .card h3 { font-size: 0.95rem; margin: 5px 0; font-weight: 700; min-height: 40px; display: flex; align-items: center; justify-content: center; }
        .price { font-weight: 900; color: var(--primary); font-size: 1.1rem; display: block; margin-bottom: 10px; }
        
        .qty-box { display: flex; justify-content: center; gap: 5px; margin-bottom: 10px; }
        .qty-input { 
            width: 50px; text-align: center; 
            border: 2px solid #eee; border-radius: 8px; 
            padding: 5px; font-weight: bold; font-family: inherit;
        }
        .qty-input:focus { outline: none; border-color: var(--primary); }

        .btn-add { 
            background: var(--primary); 
            color: white; 
            border: none; 
            padding: 10px 0; 
            width: 100%; 
            border-radius: 8px; 
            font-weight: bold; 
            cursor: pointer; 
            transition: 0.2s; 
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
        }
        .btn-add:hover { background: var(--salmon); color: white; box-shadow: 0 4px 10px rgba(255, 121, 121, 0.4); }

        /* --- PRESTI呕 --- */
        .card.prestige { 
            background: #1e1e2e; 
            color: white; 
            border: 2px solid var(--accent); 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .card.prestige img { border-color: var(--accent); }
        .card.prestige h3 { color: var(--accent); }
        .card.prestige .price { color: white; text-shadow: 0 0 10px var(--accent); }
        .card.prestige .btn-add { background: var(--accent); color: black; }
        .card.prestige .btn-add:hover { background: white; }

        /* --- KREATOR --- */
        .file-input-wrapper { 
            margin: 20px 0; 
            border: 2px dashed var(--primary); 
            padding: 30px; 
            border-radius: 15px; 
            background: #fdfdfd; 
            text-align: center;
        }

        /* --- SIDEBAR / KOSZYK --- */
        .cart-wrapper { 
            background: white; 
            padding: 30px; 
            border-radius: var(--radius); 
            border-top: 6px solid var(--salmon); 
            position: sticky; 
            top: 150px; 
            box-shadow: var(--shadow); 
        }
        .cart-items { margin-bottom: 20px; max-height: 300px; overflow-y: auto; padding-right: 5px; }
        
        /* Pasek przewijania */
        .cart-items::-webkit-scrollbar { width: 6px; }
        .cart-items::-webkit-scrollbar-thumb { background: #ddd; border-radius: 3px; }

        .cart-item { 
            display: flex; justify-content: space-between; align-items: center; 
            border-bottom: 1px dashed #eee; padding: 12px 0; font-size: 0.9rem; 
        }
        .total-row { font-size: 1.5rem; font-weight: 900; text-align: right; color: var(--primary); margin-top: 20px; }
        
        .promo-alert { 
            background: linear-gradient(to right, #dff9fb, #c7ecee); 
            color: #130f40; padding: 12px; 
            border-radius: 8px; font-size: 0.85rem; margin-top: 15px; 
            border: 1px solid #badc58; font-weight: 600;
        }
        .savings { color: #27ae60; font-weight: bold; text-align: right; display: block; font-size: 0.9rem; margin-top: 5px;}

        /* Napiwek */
        .tip-box { 
            background: #fffdf0; padding: 15px; 
            border-radius: 10px; margin: 15px 0; 
            border: 2px dashed var(--accent); 
            font-size: 0.9rem; display: flex; align-items: center; gap: 10px; cursor: pointer;
        }
        .tip-box:hover { background: #fffce0; }
        .tip-box input { transform: scale(1.4); cursor: pointer; accent-color: var(--primary); }

        /* Patnoci & Form */
        .payment-options { display: flex; gap: 10px; margin: 20px 0; }
        .pay-option { 
            flex: 1; border: 2px solid #eee; padding: 12px; text-align: center; 
            border-radius: 10px; cursor: pointer; font-size: 0.9rem; font-weight: 600; transition: 0.2s;
        }
        .pay-option:hover { border-color: #ddd; }
        .pay-option.active { border-color: var(--primary); background: #f0edff; color: var(--primary); }
        
        .blik-warn { 
            display: none; background: #ffebeb; color: #d63031; padding: 15px; 
            border-radius: 8px; font-size: 0.85rem; margin-bottom: 15px; 
            border-left: 5px solid #d63031; font-weight: bold; line-height: 1.4;
        }

        input.field { 
            width: 100%; padding: 15px; margin-bottom: 12px; 
            border: 2px solid #eee; border-radius: 10px; 
            box-sizing: border-box; font-family: inherit; transition: 0.3s;
        }
        input.field:focus { border-color: var(--primary); outline: none; background: #fcfcfc; }

        .btn-checkout { 
            background: linear-gradient(45deg, var(--primary), #6c5ce7); 
            color: white; width: 100%; padding: 18px; 
            font-size: 1.1rem; font-weight: 900; 
            border: none; border-radius: 12px; cursor: pointer; 
            margin-top: 15px; transition: 0.3s; 
            box-shadow: 0 5px 20px rgba(72, 52, 212, 0.4);
            letter-spacing: 1px;
        }
        .btn-checkout:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 10px 25px rgba(72, 52, 212, 0.5); 
            background: linear-gradient(45deg, #6c5ce7, var(--primary)); 
        }

        /* SOCIAL PROOF */
        #social-proof { 
            position: fixed; bottom: 30px; left: 30px; 
            background: white; border-left: 6px solid var(--salmon); 
            padding: 15px 20px; border-radius: 10px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.15); 
            max-width: 320px; z-index: 9999; 
            transform: translateX(-200%); transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            display: flex; gap: 15px; align-items: center; 
        }
        #social-proof.visible { transform: translateX(0); }
        #social-proof img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid #eee; }

    </style>
</head>
<body>

<div id="social-proof">
    <img src="https://via.placeholder.com/50" id="sp-img" alt="User">
    <div style="font-size:0.85rem; line-height: 1.4;">
        <strong id="sp-name" style="display:block; color:var(--primary);">Student/ka I roku</strong>
        <span id="sp-msg">Kupi Dubajsk!</span>
    </div>
</div>

<div class="header-container">
    <div class="event-banner">
         STOISKO: 15 & 18 GRUDNIA! 
        <span class="event-highlight"> Koo Fortuny</span> 
        <span class="event-highlight"> Odbi贸r</span> 
        <span class="event-highlight"> Fotobudka</span>
        <br>
        <span style="color:yellow; text-shadow: 0 1px 2px black;"> 18.12 - ZDJCIE Z DZIEKANEM! </span>
    </div>

    <header>
        <div class="nav-inner">
            <div class="logo" onclick="location.reload()">
                <img src="pinmeup_logo.jpg" alt="Logo"> PIN ME UP!
            </div>
            <a href="#koszyk" class="cart-btn">
                <i class="fa-solid fa-cart-shopping"></i> <span id="cartCount">0</span>
            </a>
        </div>
    </header>
</div>

<div class="main-wrapper">

    <div class="content-col">
        
        <div class="accordion-item active" style="border-left: 6px solid var(--salmon);">
            <div class="accordion-header" onclick="toggleAcc(this)">
                <span> WGRAJ WASN FOTK (7 PLN)</span>
                <i class="fa-solid fa-chevron-down"></i>
            </div>
            <div class="accordion-content">
                <div class="creator-section">
                    <p style="color:#666; margin-bottom:20px;">Wgraj dowolne zdjcie (kota, psa, mema), a my zrobimy z tego pina!</p>
                    
                    <div class="file-input-wrapper">
                        <i class="fa-solid fa-cloud-arrow-up" style="font-size:3rem; color:var(--primary); margin-bottom:10px;"></i><br>
                        <input type="file" id="customFile" accept="image/*" style="margin-top:10px;">
                    </div>

                    <div style="display:flex; justify-content:center; gap:10px; align-items:center;">
                        Ilo: <input type="number" id="customQty" class="qty-input" value="1" min="1" style="width:60px; font-size:1.1rem;">
                        <button class="btn-add" style="width:auto; padding:10px 40px;" onclick="addCustomFile()">DODAJ DO KOSZYKA</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="accordion-item" style="border-left: 6px solid #222;">
            <div class="accordion-header" onclick="toggleAcc(this)">
                <span> STREFA PRESTI呕U</span>
                <i class="fa-solid fa-chevron-down"></i>
            </div>
            <div class="accordion-content" style="background:#2d2d2d;">
                <div class="grid">
                    <div class="card prestige">
                        <img src="czekolada.png" alt="Dubaj">
                        <h3>Dubajska Czekolada</h3>
                        <span class="price">15.00 PLN</span>
                        <div class="qty-box"><input type="number" id="qty_dubaj" class="qty-input" value="1"></div>
                        <button class="btn-add" onclick="addItem('Dubajska Czekolada', 15, 'qty_dubaj')">BIOR</button>
                    </div>
                    <div class="card prestige">
                        <img src="labubu.png" alt="Labubu">
                        <h3>Labubu Rare</h3>
                        <span class="price">20.00 PLN</span>
                        <div class="qty-box"><input type="number" id="qty_labubu" class="qty-input" value="1"></div>
                        <button class="btn-add" onclick="addItem('Labubu Rare', 20, 'qty_labubu')">BIOR</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="accordion-item" style="border-left: 6px solid #8e44ad;">
            <div class="accordion-header" onclick="toggleAcc(this)">
                <span> BLINDBOX (NIESPODZIANKA)</span>
                <i class="fa-solid fa-chevron-down"></i>
            </div>
            <div class="accordion-content">
                <div style="display:flex; align-items:center; gap:25px; flex-wrap:wrap;">
                    <img src="question.png" style="width:100px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1);">
                    <div style="flex:1;">
                        <p style="font-weight:bold; color:var(--primary);">Lubisz ryzyko?</p>
                        <p style="font-size:0.9rem;">Kupujesz taniej (3 z), my losujemy wz贸r ze starych kolekcji lub unikat贸w.</p>
                        <div style="display:flex; gap:10px; margin-top:15px;">
                            <input type="number" id="qty_blind" class="qty-input" value="1">
                            <button class="btn-add" style="background:#8e44ad; width:auto; padding:0 30px;" onclick="addItem(' Blindbox', 3, 'qty_blind')">RYZYKUJ</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="accordion-item" style="border-left: 6px solid var(--primary);">
            <div class="accordion-header" onclick="toggleAcc(this)">
                <span> BESTSELLERY (LOGA, MEMY)</span>
                <i class="fa-solid fa-chevron-down"></i>
            </div>
            <div class="accordion-content">
                <div class="grid">
                    <div class="card">
                        <img src="logo_uczelni.png" alt="Logo">
                        <h3>Logo Wydziau</h3>
                        <span class="price">5.00 PLN</span>
                        <div class="qty-box"><input type="number" id="qty_logo" class="qty-input" value="1"></div>
                        <button class="btn-add" onclick="addItem('Logo Wydziau', 5, 'qty_logo')">DODAJ</button>
                    </div>
                    <div class="card">
                        <img src="mem_kot.png" alt="Kot">
                        <h3>Kot Student</h3>
                        <span class="price">5.00 PLN</span>
                        <div class="qty-box"><input type="number" id="qty_kot" class="qty-input" value="1"></div>
                        <button class="btn-add" onclick="addItem('Kot Student', 5, 'qty_kot')">DODAJ</button>
                    </div>
                    <div class="card">
                        <img src="gwiazda1.png" alt="Starosta">
                        <h3>Pan Starosta</h3>
                        <span class="price">6.00 PLN</span>
                        <div class="qty-box"><input type="number" id="qty_starosta" class="qty-input" value="1"></div>
                        <button class="btn-add" onclick="addItem('Pin: Starosta', 6, 'qty_starosta')">DODAJ</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="sidebar">
        
        <div style="background:white; padding:20px; border-radius:16px; margin-bottom:25px; box-shadow:var(--shadow);">
            <h4 style="margin-top:0; color:var(--primary); display:flex; align-items:center; gap:10px;">
                <i class="fa-solid fa-camera-retro"></i> Z 呕YCIA WZITE
            </h4>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px;">
                <img src="https://via.placeholder.com/150" style="width:100%; border-radius:8px; transition:0.3s; cursor:pointer;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
                <img src="https://via.placeholder.com/150" style="width:100%; border-radius:8px; transition:0.3s; cursor:pointer;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
                <img src="https://via.placeholder.com/150" style="width:100%; border-radius:8px; transition:0.3s; cursor:pointer;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
                <img src="https://via.placeholder.com/150" style="width:100%; border-radius:8px; transition:0.3s; cursor:pointer;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            </div>
        </div>

        <div id="koszyk" class="cart-wrapper">
            <h2 style="margin-top:0; color:var(--primary); font-size:1.3rem; display:flex; justify-content:space-between; align-items:center;">
                TWJ KOSZYK <i class="fa-solid fa-bag-shopping"></i>
            </h2>
            
            <div id="cartItems" class="cart-items">
                <div style="text-align:center; padding:30px; color:#aaa;">
                    <i class="fa-regular fa-face-sad-tear" style="font-size:2rem; margin-bottom:10px;"></i><br>
                    Pusto tu...
                </div>
            </div>

            <div id="promoBox"></div>

            <label class="tip-box">
                <input type="checkbox" id="tipCheck" onchange="renderCart()">
                <span><strong>Napiwek dla tw贸rc贸w</strong> <br><small style="color:#666;">(+1 PLN na monstery) わ</small></span>
            </label>

            <div class="saved-amount" id="savedDisplay"></div>
            
            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:20px; font-weight:900;">
                <span>SUMA:</span>
                <span style="font-size:1.5rem; color:var(--primary);"><span id="totalPrice">0.00</span> PLN</span>
            </div>

            <hr style="margin:25px 0; border:0; border-top:1px solid #eee;">

            <h4 style="margin-bottom:10px;">Wybierz patno:</h4>
            <div class="payment-options">
                <div class="pay-option active" id="pay_blik" onclick="setPayment('BLIK')">
                    <i class="fa-solid fa-mobile-screen-button"></i> BLIK
                </div>
                <div class="pay-option" id="pay_cash" onclick="setPayment('GOTWKA')">
                    <i class="fa-solid fa-money-bill-wave"></i> Got贸wka
                </div>
            </div>
            <input type="hidden" id="paymentMethod" value="BLIK">

            <div class="blik-warn" id="blikInfo" style="display:block;">
                锔 <strong>WA呕NE:</strong> Zr贸b przelew BLIK na telefon: <br>
                <span style="font-size:1.2rem; display:block; margin:5px 0; color:black;">123-456-789</span>
                W tytule wpisz swoje Imi!
            </div>

            <input type="text" id="clientName" class="field" placeholder="Imi i Nazwisko">
            <input type="email" id="clientEmail" class="field" placeholder="E-mail (do kontaktu)">
            
            <button class="btn-checkout" onclick="submitOrder()">
                 ZAMAWIAM TERAZ
            </button>
        </div>

        <div style="background:white; padding:20px; border-radius:16px; margin-top:25px; box-shadow:var(--shadow);">
            <h4 style="margin-top:0; color:var(--primary);"> CO MWI LUDZIE?</h4>
            <div style="border-left:3px solid var(--accent); padding-left:10px; margin-bottom:15px;">
                <p style="font-size:0.85rem; font-style:italic; margin:0;">"Kupiem Dubajsk, 偶eby zda egzamin. Zdaem."</p>
                <strong style="font-size:0.8rem;">~ Marek, II rok</strong>
            </div>
            <div style="border-left:3px solid var(--salmon); padding-left:10px;">
                <p style="font-size:0.85rem; font-style:italic; margin:0;">"Blindbox to 偶ycie. Trafiam rzadki wz贸r!"</p>
                <strong style="font-size:0.8rem;">~ Kasia, I rok</strong>
            </div>
        </div>

    </div>
</div>

<script>
    // ==========================================
    // LOGIKA SKLEPU (BEZ ZMIAN W DZIAANIU)
    // ==========================================
    
    // WPISZ TU SWJ E-MAIL !!!!
    const MY_EMAIL = "pinmeup.fuw@gmail.com"; 
    // ==========================================

    let cart = [];

    // 1. AKORDEONY
    function toggleAcc(header) {
        header.parentElement.classList.toggle('active');
    }

    // 2. FUNKCJA DODAWANIA (ZWYKE PRODUKTY)
    function addItem(name, price, inputId) {
        const qty = parseInt(document.getElementById(inputId).value);
        if(qty < 1) return;

        // Sprawd藕 czy ju偶 jest w koszyku
        const existing = cart.find(item => item.name === name && !item.file);
        
        if(existing) {
            existing.qty += qty;
        } else {
            cart.push({ name: name, price: price, qty: qty, file: null });
        }

        // Reset inputa
        document.getElementById(inputId).value = 1;
        renderCart();
        
        // May efekt wizualny na koszyku
        const cartBtn = document.querySelector('.cart-btn');
        cartBtn.style.transform = "scale(1.2)";
        setTimeout(() => cartBtn.style.transform = "scale(1)", 200);
    }

    // 3. FUNKCJA DODAWANIA (WASNY PLIK)
    function addCustomFile() {
        const fileInput = document.getElementById('customFile');
        const qty = parseInt(document.getElementById('customQty').value);

        if(fileInput.files.length === 0) {
            alert("Najpierw wybierz plik!");
            return;
        }

        const file = fileInput.files[0];
        
        cart.push({
            name: "Wasny Projekt (" + file.name + ")",
            price: 7.00,
            qty: qty,
            file: file
        });

        fileInput.value = ""; 
        document.getElementById('customQty').value = 1;
        renderCart();
        alert("Dodano Tw贸j projekt do koszyka!");
    }

    // 4. USUWANIE Z KOSZYKA
    function removeItem(index) {
        cart.splice(index, 1);
        renderCart();
    }

    // 5. RENDEROWANIE KOSZYKA
    function renderCart() {
        const container = document.getElementById('cartItems');
        const totalEl = document.getElementById('totalPrice');
        const promoBox = document.getElementById('promoBox');
        const savedEl = document.getElementById('savedDisplay');
        
        const isTip = document.getElementById('tipCheck').checked;

        container.innerHTML = "";
        let total = 0;
        let savings = 0;
        let promoText = "";

        if(cart.length === 0 && !isTip) {
            container.innerHTML = '<div style="text-align:center; padding:30px; color:#aaa;"><i class="fa-regular fa-face-sad-tear" style="font-size:2rem; margin-bottom:10px;"></i><br>Tw贸j koszyk jest pusty</div>';
            totalEl.innerText = "0.00";
            promoBox.innerHTML = "";
            savedEl.innerText = "";
            document.getElementById('cartCount').innerText = "0";
            return;
        }

        cart.forEach((item, index) => {
            let itemTotal = item.price * item.qty;

            // Logika Dubajska (Rabat)
            if(item.name.includes("Dubajska")) savings += (150 - 15) * item.qty;
            if(item.name.includes("Labubu")) savings += (500 - 20) * item.qty;

            // Logika 5+1 Gratis
            if(!item.file && item.qty >= 6) {
                const freeCount = Math.floor(item.qty / 6);
                const discount = freeCount * item.price;
                itemTotal -= discount;
                savings += discount;
                promoText = `<div> Promocja 5+1: Odejmujemy ${discount.toFixed(2)} z!</div>`;
            }

            total += itemTotal;

            const div = document.createElement('div');
            div.className = 'cart-item';
            div.innerHTML = `
                <div>
                    <strong>${item.name}</strong> <br>
                    <small style="color:#777;">${item.qty} szt. x ${item.price} z</small>
                </div>
                <div style="display:flex; align-items:center; gap:10px;">
                    <strong>${itemTotal.toFixed(2)} z</strong>
                    <i class="fa-solid fa-trash" style="color:#ff7979; cursor:pointer;" onclick="removeItem(${index})"></i>
                </div>
            `;
            container.appendChild(div);
        });

        if(isTip) {
            total += 1.00;
            const div = document.createElement('div');
            div.className = 'cart-item';
            div.style.color = 'var(--salmon)';
            div.innerHTML = `<div>わ <strong>Napiwek</strong></div><div>1.00 z</div>`;
            container.appendChild(div);
        }

        totalEl.innerText = total.toFixed(2);
        
        const totalQty = cart.reduce((acc, item) => acc + item.qty, 0);
        document.getElementById('cartCount').innerText = totalQty;

        promoBox.innerHTML = promoText ? `<div class="promo-alert">${promoText}</div>` : "";
        savedEl.innerText = savings > 0 ? `OSZCZDZASZ: ${savings.toFixed(2)} PLN!` : "";
    }

    // 6. PATNOCI
    function setPayment(type) {
        document.querySelectorAll('.pay-option').forEach(el => el.classList.remove('active'));
        if(type === 'BLIK') {
            document.getElementById('pay_blik').classList.add('active');
            document.getElementById('blikInfo').style.display = 'block';
        } else {
            document.getElementById('pay_cash').classList.add('active');
            document.getElementById('blikInfo').style.display = 'none';
        }
        document.getElementById('paymentMethod').value = type;
    }

    // 7. WYSYANIE ZAMWIENIA
    function submitOrder() {
        if(cart.length === 0 && !document.getElementById('tipCheck').checked) { alert("Koszyk jest pusty!"); return; }

        const name = document.getElementById('clientName').value;
        const email = document.getElementById('clientEmail').value;
        const method = document.getElementById('paymentMethod').value;
        
        if(!name || !email) { alert("Podaj Imi i E-mail!"); return; }

        const btn = document.querySelector('.btn-checkout');
        const originalText = btn.innerText;
        btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> WYSYANIE...';
        btn.disabled = true;

        const formData = new FormData();
        
        formData.append("_captcha", "false");
        formData.append("_subject", "NOWE ZAMWIENIE PIN ME UP: " + name);
        formData.append("_template", "table"); 

        formData.append("Klient", name);
        formData.append("Email", email);
        formData.append("Patno", method);
        formData.append("DO ZAPATY", document.getElementById('totalPrice').innerText + " PLN");
        
        if(document.getElementById('tipCheck').checked) {
            formData.append("Napiwek", "TAK (+1 PLN)");
        }

        let orderSummary = "";
        let fileIndex = 1;

        cart.forEach((item) => {
            orderSummary += `${item.name} | Ilo: ${item.qty} \n`;
            if(item.file) {
                const fileName = `Projekt_${name.replace(/\s/g,'_')}_${fileIndex}`; 
                formData.append(fileName, item.file); 
                fileIndex++;
            }
        });

        formData.append("ZAMWIENIE", orderSummary);

        fetch(`https://formsubmit.co/${MY_EMAIL}`, {
            method: "POST",
            body: formData
        })
        .then(response => {
            alert("SUKCES! Zam贸wienie wysane. Sprawd藕 maila (r贸wnie偶 SPAM).");
            cart = [];
            document.getElementById('tipCheck').checked = false;
            renderCart();
            document.getElementById('clientName').value = "";
            btn.innerText = originalText;
            btn.disabled = false;
        })
        .catch(error => {
            alert("Zam贸wienie wysane! (Jeli nie widzisz maila, sprawd藕 spam).");
            console.log(error);
            btn.innerText = originalText;
            btn.disabled = false;
        });
    }

    // Social Proof Timer
    setInterval(() => {
        const box = document.getElementById('social-proof');
        const msgs = ["Zrobi zdjcie z Dziekanem", "Kupi Dubajsk!", "Zrobi wasny projekt.", "Wzi Blindboxa.", "Dosta gratis 5+1."];
        document.getElementById('sp-msg').innerText = msgs[Math.floor(Math.random()*msgs.length)];
        box.classList.add('visible');
        setTimeout(()=>box.classList.remove('visible'), 5000);
    }, 15000);

</script>

</body>
</html>
